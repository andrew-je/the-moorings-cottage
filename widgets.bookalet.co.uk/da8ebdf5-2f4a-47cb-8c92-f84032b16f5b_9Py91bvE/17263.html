<!DOCTYPE html>
<!--[if lte IE 9 ]><html class="legacy"> <![endif]-->
<!--[if (gt IE 9)]><!--><html><!--<![endif]-->
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Moorings Cottage - Online Booking</title>
    <link href='/Content/css/widget.css?v=10190' rel='stylesheet' type='text/css'>
    <link href='/Theme/colour_4588D9.css?v=10190' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,600,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="/Content/js/jquery.validate.min.js"></script>
    <script src='/Content/js/widget.min.js?v=10190'></script>
    <script>svg4everybody();</script>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
</head>
<body class="bookaletwidget" data-id="da8ebdf5-2f4a-47cb-8c92-f84032b16f5b_9Py91bvE" data-parent="https://secure.bookalet.co.uk/widget?id=da8ebdf5-2f4a-47cb-8c92-f84032b16f5b&amp;property=17263&amp;monthcount=1">
    <div id="widget" class="widget widget--calendar widget--compact">
<h1 class="header">The Moorings Cottage - Online Booking</h1>        <div class='widget_content widget_content--withheader'>
            
    <script>
    var adults = 0;
    var children = 0;
    var infants = 0;
    var bookingModal = null;
    var dayRentals = [];

    $(document).ready(function () {
        $('.calendar_inner').BookaletCalendar({
            baseUrl: '/da8ebdf5-2f4a-47cb-8c92-f84032b16f5b_9Py91bvE',
            properties: [                { Id: 17263 ,
                Units:[
]}
],
            group: -1,
            monthCount: 1,
            weekStart: 1,
            fromMonth: 4,
            fromYear: 2023,
            toMonth:  4,
            toYear: 2028,
            showKeyTop: false,
            showKeyBottom: true,
            showUnavailable: true,
            owner: 6342,
            canBook: true,
            theme: 0,
            linkToDetails: false,
            linkToDetailsNewWindow: false,
            unitsRequired: 1,
            dayClick: function(data) {
                if (typeof bookableClick == 'function') {
                    bookableClick(data);
                }
            }
        });

        
        function bookableClick(data) {
            if (data !== null && data.bookable) {
                window.scrollTo(0,0);
                bookalet.scrollTop();
                
                    bindForm(data.owner, data.property, data.date, null, 4, 4, 3, 1, 1);
                
            }
        }

        bookingModal = $('#booking_start').Modal();

        $('#booking_nights, #currency').on('change', function (e) {
            e.preventDefault();
            var nights = $("#booking_nights").val();
            if (nights >= 1)
            {
                bookingModal.data('nights', nights);
                bindNights(6342, { Id: bookingModal.data('property') }, parseInt($('#UnitsRequired').val()), bookingModal.data('arrival'), bookingModal.data('nights'), adults, children, infants);
            }
            else
            {
                $('#departure').text('Please select arrival date/length of stay').addClass('placeholder');
                bookingModal.removeData('departure');
                bookingModal.Modal("redraw");
            }
        });

        $('#units_required').on('change', function (e) {
            e.preventDefault();
            if ($("#booking_nights option:selected").attr("data-cost") !== undefined)
                $('#totalPrice').text($("#booking_nights option:selected").attr("data-cur") + parseFloat(parseFloat($("#booking_nights option:selected").attr("data-cost")) * parseInt($(this).val())).toFixed(2));
            else {
                $('#totalPrice').text("");
                $('#booking_continue').addClass('hidden');
            }
            unitsRequired = parseInt($(this).val());
            $('#UnitsRequired').val(unitsRequired);

            totalExchangePrice = $("#Cost").val() * ((1 / $("#CurrencyFrom").val()) * $("#CurrencyTo").val()) * unitsRequired;
            $("#totalExchangePrice").text($('#currency').find(':selected').data('currency') + totalExchangePrice.toFixed(2));
        });

        $('.cancel').on('click', function (e) {
            e.preventDefault();
            bookingModal.data('arrival', '');
            bookingModal.data('departure', '');
            $('#departure').text('Please select arrival date/length of stay').addClass('placeholder');
            $('#totalPrice').text('');
            $('#booking_nights').empty();
            $('.error').remove();
            $("#totalExchanged").hide();
            $("#convert").hide();
            $('#currency').val('');
            $("#totalExchangePrice").text('');
            bookingModal.Modal('hide');
        });
        
    });

    function bindForm(owner, property, arrival, nights, sleeps, sleepsAdults, sleepsChildren, sleepsInfants, unitsRequired) {
        bookingModal.data('property', property.Id);
        $('#booking_arrival').val(arrival.format('YYYY-MM-DD'));
        $('#arrival').text(arrival.format('dddd Do MMMM YYYY')).removeClass('placeholder');
        $('#booking_nights_field').removeClass('booking_nights--select');

        $('#Property').val(property.Id);
        $('#Adults').val(adults);
        $('#Children').val(children);
        $('#Infants').val(infants);

        if (nights == undefined) nights = 0;
        if (sleeps == undefined) sleeps = 20;

        if (adults > sleepsAdults){
            adults = sleepsAdults;
        }

        $('.arrivaldate_label').text('Arrival Date:');
        $('.booking_dayrental').removeClass('booking_dayrental--hidden');
        if ($.inArray(property.Id, dayRentals) > -1) {
            nights = 1;
            $('.arrivaldate_label').text('Date:');
            $('.booking_dayrental').addClass('booking_dayrental--hidden');
        }

        bookingModal.data('arrival', arrival);
        bookingModal.data('sleepsAdults', sleepsAdults);
        bookingModal.data('sleepsChildren', sleepsChildren);
        bookingModal.data('sleepsInfants', sleepsInfants);

        bindNights(owner, property, unitsRequired, arrival, nights);
        bookingModal.Modal('show');
    }

    function bindNights(owner, property, unitsRequired, arrival, nights)
    {
        if (!unitsRequired > 0) unitsRequired = parseInt($("#units_required").val()) > 0 ? parseInt($("#units_required").val()) : 1;

        $('#booking_nights_field').removeClass('booking_nights--loaded').addClass('booking_nights--loading');
        var select = $('#booking_nights');
        var exchange = $('#currency').val();
        $.ajax({
            url: '/api/bookable',
            data: {
                owner: owner,
                property: property.Id,
                UnitsRequired: unitsRequired > 0 ? unitsRequired : 1,
                date: arrival.format('YYYY-MM-DD'),
                nights: nights,
                adults: adults,
                children: children,
                infants: infants,
                exchange: exchange
            },
            type: 'GET',
            async: true,
            cache: false,
            error: function (msg) {

            },
            success: function (msg) {
                select.empty();
                select.append($('<option value="0">Please select</option>'));
                for (i in msg) {
                    var data = msg[i];
                    var selected = "";
                    var cost = parseFloat(Math.round((data.Cost - data.Discount) * 100) / 100).toFixed(2);
                    totalExchangePrice = cost * ((1 / data.ExchangeFrom) * data.Exchange) * unitsRequired;
                    $("#Cost").val(cost);
                    $("#propcurrency").text(data.Currency);

                    if (nights > 0 && data.Days == nights)
                    {
                        var departure = bookingModal.data('arrival').clone().add(nights, 'days');
                        $('#departure').text(departure.format('dddd Do MMMM YYYY')).removeClass('placeholder');
                        $('#totalPrice').text(data.Currency + (cost * unitsRequired).toFixed(2));
                        bookingModal.data('departure', departure);
                        $('#booking_continue').removeClass('hidden');
                        selected = ' selected="selected"';
                    }
                    select.append($('<option'+ selected +' value="' + data.Days + '" data-cost="' + cost + '" data-units="' + data.Units + '" data-cur="' + data.Currency + '" data-avail="' + data.AvailableUnits + '">' + data.Days + ' ' + (data.Days == 1 ? 'night' : 'nights') + ' (' + (data.Units > 1 ? data.AvailableUnits + ' Available - ' : '') + data.Currency + cost + ')</option>'));
                }
                $('#booking_nights_field').removeClass('booking_nights--loading').addClass('booking_nights--loaded');
                $("#units_required").empty();
                if (data.Units > 1) {
                    $("#required_section").show();
                     for (i = 0; i < parseInt($("#booking_nights option:selected").attr("data-avail")); i++) {
                        $("#units_required").append($('<option' + (data.UnitsRequired == i+1 ? ' selected': '') + '>' + (i + 1) + '</option>'))
                    }
                }
                else {
                    $("#required_section").hide();
                }
                bookingModal.Modal("redraw");
            }
        });
    }

    </script>
<div class="calendar_wrapper calendar_wrapper--single calendar_wrapper--single_bookable">
    <div class="calendar_inner">
    </div>
</div>
<div id="booking_start" class="modal booking_start--single">
    <form method="post" class="modal_inner">
        <input type="hidden" id="Property" name="Property" />
        <input type="hidden" id="Cost" name="Cost" />
        <input type="hidden" id="UnitsRequired" name="UnitsRequired" />
        <input type="hidden" id="CurrencyFrom" name="CurrencyFrom" value="0" />
        <input type="hidden" id="CurrencyTo" name="CurrencyTo" value="0" />
        <input type="hidden" id="CurrencyToChar" name="CurrencyToChar" />
        <input type="hidden" id="Adults" name="Adults" />
        <input type="hidden" id="Children" name="Children" />
        <input type="hidden" id="Infants" name="Infants" />
        <h2 class="header modal_header">The Moorings Cottage - Online Booking</h2>
        <div class="modal_content">
                <div id="booking_start_top" class="clearfix">
                    <div class="form_row">
                        <label class="arrivaldate_label">Arrival Date:</label>
                        <p id="arrival" class="form_field placeholder">Please select from calendar</p>
                        <input type="hidden" id="booking_arrival" name="arrival" />
                    </div>
                    <div class="booking_dayrental">
                        <div class="form_row">
                            <label>Nights:</label>
                            <div id="booking_nights_field" class="form_field booking_nights--select">
                                <div id="booking_nights_select">Please select an arrival date</div>
                                <div id="booking_nights_loader">Loading prices...</div>
                                <select id="booking_nights" name="nights"></select>
                            </div>
                        </div>

                        <div class="form_row">
                            <label>Departure Date:</label>
                            <p id="departure" class="form_field placeholder">Please select arrival date/length of stay</p>
                        </div>
                    </div>

                    <div class="form_row" id="required_section" style="display:none;">
                        <label class="numrequired_label">Required:</label>
                        <div class="form_field">
                            <select name="units_required" id="units_required">
                            </select>
                        </div>
                    </div>

                </div>
                <div class="booking_start_btm divider clearfix">
                    <div class="validation-summary-valid error" data-valmsg-summary="true"><ul><li style="display:none"></li>
</ul></div>
                    <fieldset class="total">
                        <label>Total:</label>
                        <span id="totalPrice"></span>
                        <span id="totalExchanged" style="display:none"><br />(Approx <span id="totalExchangePrice"></span>)</span>
                    </fieldset>
                    <div id="convert" style="display:none">
                        View In <select id="currency" name="currency" class="form_field--select" style="font-size: 1em;">
    <option value="" data-currency="">(Select Currency)</option>
    <option value="GBP" data-currency="&pound;">British pound</option>
    <option value="EUR" data-currency="&euro;">Euro</option>
    <option value="USD" data-currency="$">US dollar</option>
    <option value="AUD" data-currency="$">Australian dollar</option>
    <option value="CHF" data-currency="CHF">Swiss franc</option>
    <option value="ZAR" data-currency="R">South African</option>
    <option value="CAD" data-currency="$">Canadian dollar</option>
    <option value="DKK" data-currency="kr">Danish Kroner</option>
    <option value="NOK" data-currency="kr">Norwegian Kroner</option>
    <option value="SEK" data-currency="kr">Swedish Krona</option>
    <option value="BRL" data-currency="R$">Brazilian Reais</option>
</select><br />
                        <small>Currency rates are for information only. All payments will be made in <span id="propcurrency"></span></small>
                    </div>
                    <div class="form_buttons form_buttons--cancel">
                        <button id="booking_continue" class="button hidden">Continue</button>
                        <a class="cancel" href="#">Cancel</a>
                    </div>
                </div>
        </div>
    </form>
</div>

        </div>
        
        <p class="poweredby" style="display:block!important;visibility:visible!important;color:inherit!important;width:100%!important;height:3em!important;padding: 5px 0 10px!important;text-indent:0!important;font-size:11px!important;min-height:33px!important;"><a href="https://www.bookalet.co.uk" target="_blank" style="display:inline!important;visibility:visible!important;color:inherit!important;width:100%!important;height:3em!important;margin:0!important;">Powered by <strong>bookalet</strong><span> - holiday home promotion & booking management</span></a></p>
    </div>
    
</body>
</html>
